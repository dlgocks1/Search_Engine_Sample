キーワード samba smb.conf チューニング 1G 1000M ギガビット
やりたいこと
LANをすべてギガビット化してみたものの, WindowsクライアントとSambaサーバの通信で
1Gの恩恵を受けられていない様な気がする. 
体感速度があまり変わらないので少し設定をいじってみる. 
▲ ▼
チューニング1: smb.conf
従来の100M環境では, チューニングで 8192 が推奨されていたが,
GbE環境では不足なので数を足してやる.
# vi /etc/samba/smb.conf
socket options = TCP_NODELAY SO_RCVBUF=16384 SO_SNDBUF=16384
シーケンシャルなI/Oで250Mbps程度まで速度が出るようになった.
▲ ▼
チューニング2: MTU設定(ジャンボフレーム対応化)
下記3つの条件を満たしている環境の場合,
SambaサーバのNICのMTU値を大きくすることで通信の効率化ができる.
SambaサーバのNIC(のドライバ)が1500以上のMTUをサポートすること
中継するネットワーク機器(ハブなど)が1500以上のイーサネットフレームが通過可能なこと
Sambaクライアント(Windows)がジャンボフレームに対応してあり,適切に設定されていること
残念ながら手元のML115 G5はジャンボフレーム非対応だった.
# ifconfig eth0 mtu 2000
SIOCSIFMTU: Invalid argument
▲ ▼
Linux, ストレージ, 冗長化, RHCS | 22:06前置きが長かったが、cmirrorを使ってみる。 ww 前回までの構成に加えて、cmirror を使うには、まずiSCSIで2つの同じ大きさのディスクを用意しておく。 ( /dev/hda, /dev/hdb とする)ここで、前回はまずclvmd までを起動したのだが、今回はこれに加えて
# service cmirror start
を各ノードで実行する。プロセス clogd が上がっていれば成功である。この後、普通にVGまで作成した後、
# lvcreate -L 1G -n iscsilv1 --alloc anywhere -m1 iscsivg1
のように、LVMミラーリングと同じコマンドでLVを作成する。この後、GFSを作成し、openfilerを片方落としてみて、ファイルの読み書きが継続できれば成功である。(lvdisplay 等で入出力エラーがでるのは正常な動作) ファイルのミラーリングは、Openfiler などのストレージ側でも対応できそうなので、サーバー側で行う必要があるかどうかは微妙なところだが、エントリー向けのモデルなど、ミラーリングができないモデルを使う際には、冗長性を保つ方法として、有効になりそうだ。